(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[593],{2045:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mines",function(){return a(9117)}])},7523:function(e,t,a){"use strict";a.d(t,{Z:function(){return battle_filter_v2}});var n,s,l=a(1527),i=a(959),r=a(8519),o=a(3837),d=a(2187),u=a.n(d);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var multiplayer=function(e){return i.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:16,height:14,fill:"none"},e),n||(n=i.createElement("path",{d:"M4.842 6.741c.796 0 1.56-.306 2.123-.852.563-.545.88-1.285.88-2.056 0-.772-.317-1.512-.88-2.057A3.052 3.052 0 0 0 4.842.924c-.797 0-1.56.306-2.123.852a2.863 2.863 0 0 0-.88 2.057c0 .77.317 1.51.88 2.056a3.052 3.052 0 0 0 2.123.852Zm6.755 0c.598 0 1.17-.23 1.593-.639.422-.409.66-.964.66-1.542 0-.579-.238-1.134-.66-1.543a2.29 2.29 0 0 0-1.593-.639c-.597 0-1.17.23-1.592.64-.422.408-.66.963-.66 1.542 0 .578.238 1.133.66 1.542.422.41.995.64 1.592.64ZM2.215 8.196c-1.036 0-1.877.814-1.877 1.818 0 0 0 3.272 4.504 3.272 3.57 0 4.31-2.057 4.463-2.909.04-.223.04-.364.04-.364 0-1.003-.84-1.817-1.876-1.817H2.215Zm8.626 2.327a3.742 3.742 0 0 1-.135.779 4.13 4.13 0 0 1-.514 1.113c.46.1.932.148 1.404.144 3.753 0 3.753-2.545 3.753-2.545 0-1.004-.84-1.818-1.877-1.818h-3.196c.36.52.57 1.144.57 1.818v.363l-.005.146Z",fill:"#C2C2C2"})))};function singleplayer_extends(){return(singleplayer_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var singleplayer=function(e){return i.createElement("svg",singleplayer_extends({xmlns:"http://www.w3.org/2000/svg",width:11,height:14,fill:"none"},e),s||(s=i.createElement("path",{d:"M9.104 8.135a1.545 1.545 0 0 1 1.545 1.545v.368c0 1.842-2.168 3.237-5.15 3.237s-5.15-1.322-5.15-3.237V9.68a1.545 1.545 0 0 1 1.545-1.545h7.21ZM5.499.925a3.09 3.09 0 1 1 0 6.18 3.09 3.09 0 0 1 0-6.18Z",fill:"#C2C2C2"})))},c=a(1480),m=a.n(c),mutiplayer_tabs=function(e){let{tabsContent:t=[],currentTab:a,setCurrentTab:n,className:s}=e;return(0,l.jsxs)("div",{className:u()(m().Tabs,s,m().multiPlayerOnes),children:[(0,l.jsx)("span",{className:m().TabsActive,style:{width:"".concat(100/t.length,"%"),left:"".concat(100/t.length*t.indexOf(a),"%")}}),t.map((e,s)=>(0,l.jsxs)("button",{style:a===e?{color:"#F2F2F2",width:"".concat(100/t.length,"%")}:{width:"".concat(100/t.length,"%")},onClick:()=>n(t=>({...t,tabName:e})),children:["Multiplayer"===e?(0,l.jsx)(multiplayer,{}):(0,l.jsx)(singleplayer,{}),e]},s))]})},_=a(1644),b=a(6131),h=a(4156),p=a.n(h),battle_filter_v2=function(e){let{battlesCount:t,gameName:a,showJoinable:n,handleCreateBattle:s,setShowJoinable:i,setCurrentTab:d,currentTab:u,showTotalValue:c}=e,m=(0,b.L)(e=>e.globalUser),h=(0,b.a)(e=>e.setShowLogin);return(0,l.jsxs)("div",{className:p().filterWrapperV2,children:[(0,l.jsx)("div",{className:p().tabsContainer,children:(0,l.jsx)(mutiplayer_tabs,{className:p().Tabs,currentTab:u.tabName,setCurrentTab:d,tabsContent:"Mines"!==a?["Multiplayer","SinglePlayer"]:["SinglePlayer","Multiplayer"]})}),"SinglePlayer"!=u.tabName&&(0,l.jsxs)("div",{className:p().filterWrapperRight,children:[(0,l.jsxs)("div",{className:p().filled,children:[(0,l.jsx)("span",{className:p().greenDot}),(0,l.jsxs)(_.Z,{element:"p",textType:"label",children:[t," ",1==t?"public battle":"public battles"]}),(0,l.jsx)("span",{className:p().greyDot}),(0,l.jsx)(_.Z,{element:"p",textType:"label",children:"Show Joinable"}),(0,l.jsx)(o.Z,{checked:n,onChange:()=>{localStorage.setItem("show_joinable",JSON.stringify(!n)),i(!n)}})]}),(0,l.jsxs)(r.Z,{className:p().btn,variant:"primary",onClick:()=>{(null==m?void 0:m.id)?s():h({forceUserPass:!1,visible:!0})},children:["Create ",a]})]})]})}},9117:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Mines}});var n=a(1527),s=a(2187),l=a.n(s),i=a(6284),r=a(959),o=a(462),d=a(7523),u=a(2524),c=a(7572),m=a(528),_=a(4139),b=a.n(_),h=a(6131),p=a(896),f=a(4641),g=a(8863),y=a(152),N=a.n(y),E=a(8519),single_mines_canvas=e=>{let{field:t,isGameActive:a,handleFlipMine:s,className:i,...r}=e;return(0,n.jsx)("div",{className:l()(N().minesCanvas,!a&&N().minesCanvasDisabled,i),...r,children:(0,n.jsx)("div",{className:N().tilesContainer,children:t.map(e=>(0,n.jsx)(E.Z,{disabled:"loading"==e.field||"coin"==e.field,onClick:()=>{s(e.id)},className:l()(N().tile,N().misteryTile,"mine"==e.field&&N().badTile,"coin"==e.field&&N().goodTile,"loading"==e.field&&N().loadingTile)},e.id))})})},S=a(252),C=a(802),v=a(4551),x=a.n(v),single_mines_controls=e=>{let{bet:t,setBet:a,mines:s,setMines:i,isGameActive:r,handleStartGame:o,handleCashout:d,openModal:u,totalEarnings:c,multiplier:m,..._}=e;return(0,n.jsxs)("div",{className:x().towerControls,..._,children:[(0,n.jsxs)("div",{className:x().buttonsRow,children:[(0,n.jsx)(E.Z,{className:x().manualBtn,children:"Manual"}),(0,n.jsxs)("div",{children:[(0,n.jsx)(E.Z,{className:x().fairnessBtn,onClick:()=>{u()},children:"Fairness"}),(0,n.jsx)(E.Z,{className:x().fairnessBtn,children:"History"})]})]}),(0,n.jsxs)("div",{className:x().betAmountRow,children:[(0,n.jsx)("label",{children:"Robux Amount"}),(0,n.jsx)(C.Z,{placeholder:"100",hasCurrencyIcon:!0,half:!r,maxi:!r,type:"number",value:t,className:x().amountInput,setBattleCost:a,double:!r,disabled:r,onChange:e=>{Number(e.target.value)>25e3?a("25000"):0>Number(e.target.value)?a(""):a(e.target.value)}})]}),(0,n.jsxs)("div",{className:x().betAmountRow,children:[(0,n.jsx)("label",{children:"Mines"}),(0,n.jsx)(C.Z,{placeholder:"2",type:"number",readOnly:!0,value:s,className:x().amountInput,setBattleCost:i,minesButtons:!r,disabled:r,onChange:e=>{i(e.currentTarget.value)}})]}),(0,n.jsxs)("div",{className:x().payoutRow,children:[(0,n.jsxs)("label",{children:["Total earnings ",m>0&&"".concat(m.toFixed(2),"x")]}),(0,n.jsx)(C.Z,{placeholder:"Will appear after game starts",readOnly:!0,type:"text",className:x().payoutInput,value:c?"+"+(0,S.s)(c)+" Robux":""})]}),r?(0,n.jsxs)(E.Z,{onClick:()=>{d()},className:l()(x().startGameBtn,x().cashoutBtn),variant:"primary",children:["Cashout ",m>0&&"(".concat(m.toFixed(2),"x)")]}):(0,n.jsx)(E.Z,{onClick:()=>{o()},className:x().startGameBtn,variant:"primary",children:"Start mines game"})]})};let I=Array(25).fill(0).map((e,t)=>({id:t,field:"hidden"}));var single_mines=()=>{let e=(0,h.L)(e=>e.globalUser),t=(0,h.a)(e=>e.setShowLogin),a=(0,h.a)(e=>e.setShowModal),s=(0,h.a)(e=>e.setMinesFairnessData),i=(0,r.useMemo)(()=>(0,f.P)("margin"),["margin"]),[o,d]=(0,r.useState)("0"),u=(0,r.useRef)(o),[c,_]=(0,r.useState)("1"),[y,N]=(0,r.useState)(I),[E,S]=(0,r.useState)(0),[C,v]=(0,r.useState)(0),[M,B]=(0,r.useState)(!1),setFieldCell=(e,t)=>{N(a=>a.map(a=>a.id===e?{...a,field:t}:a))},fetchState=async()=>{let e=await (0,p.OL)();B(e.isCurrentgame),e.currentGameData&&(d(e.currentGameData.gameCost),v(e.currentGameData.multiplier),S(e.currentGameData.amountWonAT),_(e.currentGameData.bombs),e.currentGameData.flippedTiles.forEach(e=>{setFieldCell(e,"coin")}),s({hashedServerSeed:e.currentGameData.hashedServerSeed,clientSeed:e.currentGameData.clientSeed,nonce:e.currentGameData.id,serverSeed:""}))};return(0,r.useEffect)(()=>{u.current=o},[o]),(0,r.useEffect)(()=>(fetchState(),g.Wb.on("CREATE_SINGLE_MINES_SUCCESS",e=>{let{hashedServerSeed:t,bombs:a,clientSeed:n,nonce:l}=e;N(I),B(!0),s({hashedServerSeed:t,clientSeed:n,nonce:l,serverSeed:""})}),g.Wb.on("CREATE_SINGLE_MINES_FAIL",e=>{m.ZP.error(e)}),g.Wb.on("FLIP_MINE_ERROR",e=>{m.ZP.error(e)}),g.Wb.on("FLIP_SINGLE_MINE_SUCCESS",e=>{let{positionNumber:t,amountWonAT:a,multiplier:n}=e;setFieldCell(t,"coin"),S(a),v(n);let s=new Audio("/sounds/count_end.ogg");s.volume=.4,s.play()}),g.Wb.on("FLIP_SINGLE_MINE_BOMB",e=>{let{positionNumber:t,game:a}=e;a.bombPositions.map(e=>{console.log(e),setFieldCell(e,"mine")});let n=new Audio("/sounds/failed.wav");n.volume=1,n.play(),B(!1),S(0),v(0);let s=Number(u.current);m.ZP.error(isNaN(s)?"You've lost!":"You've lost ".concat(s.toFixed(2)," Robux!"))}),g.Wb.on("CASHOUT_SINGLE_MINES_FAIL",e=>{m.ZP.error(e)}),g.Wb.on("CASHOUT_SINGLE_MINE_SUCCESS",e=>{let{serverSeed:t,game:a,amountWonAT:n}=e;console.log(a),a.bombPositions.map(e=>{console.log(e),setFieldCell(e,"mine")}),B(!1),S(0),v(0),m.ZP.success("You've won ".concat(n.toFixed(2)," Robux!")),console.log(n),s({serverSeed:t})}),()=>{g.Wb.off("CREATE_SINGLE_MINES_SUCCESS"),g.Wb.off("CREATE_SINGLE_MINES_FAIL"),g.Wb.off("FLIP_MINE_ERROR"),g.Wb.off("FLIP_SINGLE_MINE_SUCCESS"),g.Wb.off("FLIP_SINGLE_MINE_BOMB"),g.Wb.off("CASHOUT_SINGLE_MINE_FAIL"),g.Wb.off("CASHOUT_SINGLE_MINE_SUCCESS")}),[]),(0,n.jsx)("div",{className:l()(b().insideBattlePage),children:(0,n.jsxs)("div",{className:l()(b().battleLayout,x().singleMines),children:[(0,n.jsx)("div",{style:{width:"35%"},className:b().battleColumnLeft,children:(0,n.jsx)(single_mines_controls,{bet:o,setBet:d,mines:c,setMines:_,isGameActive:M,handleStartGame:()=>{(null==e?void 0:e.id)?g.Wb.emit("CREATE_SINGLE_MINES_GAME",{bombs:Number(c),gameCost:o}):t({forceUserPass:!1,visible:!0})},handleCashout:()=>{g.Wb.emit("CASHOUT_SINGLE_MINES")},openModal:function(){a("showMinesFairness",!0),setTimeout(()=>{document.body.style.overflow="hidden",document.body.style.paddingRight=i.gap+"px"},0)},totalEarnings:E,multiplier:C})}),(0,n.jsx)(single_mines_canvas,{handleFlipMine:e=>{g.Wb.emit("FLIP_SINGLE_MINE",e)},field:y,isGameActive:M,className:l()(b().battleColumnRight,x().fieldCol)})]})})};let M={name:"Mines",info:"Players take turns flipping tiles individually. If a player flips a tile revealing a bomb, they are eliminated; the last person standing wins!"};function Mines(){let e=(0,i.useRouter)(),t=(0,h.L)(e=>e.globalUser),a=r.useMemo(()=>(0,f.P)("margin"),["margin"]),s=(0,h.a)(e=>e.setShowModal),o=(0,h.a)(e=>e.setShowLogin),[m,_]=(0,r.useState)([]),[b,y]=(0,r.useState)(!1),[N,E]=(0,r.useState)({tabName:"SinglePlayer",tabNumber:0}),addNewBattle=e=>{_(t=>[e,...t])},handleBattleEnd=e=>{_(t=>t.filter(t=>{let{id:a}=t;return a!==e}))},handleAddMember=e=>{_(t=>{let a=[...t],n=a.findIndex(t=>{let{id:a}=t;return a===e.battleId});return -1!==n&&a[n].players.push(e.player),a})},fetchInitialData=async()=>{var e;let{data:t}=null!==(e=await (0,p.Uk)("mines"))&&void 0!==e?e:{};_(t)};(0,r.useEffect)(()=>{var e;return g.Wb.emit("JOIN-ROOM","GENERAL-MINES"),g.Wb.on("NEW_MINES_BATTLE",addNewBattle),g.Wb.on("ADD_MEMBER",handleAddMember),g.Wb.on("REMOVE_BATTLE",handleBattleEnd),y(JSON.parse(null!==(e=localStorage.getItem("show_joinable"))&&void 0!==e?e:"false")),fetchInitialData(),()=>{g.Wb.off("NEW_MINES_BATTLE"),g.Wb.off("REMOVE_BATTLE"),g.Wb.off("ADD_MEMBER")}},[]);let joinFromOutside=a=>{(null==t?void 0:t.id)?(e.push("/mines/".concat(a)),setTimeout(()=>{g.Wb.emit("JOIN_MINES_BATTLE",a)})):o({forceUserPass:!1,visible:!0})};return m?(0,n.jsxs)("div",{className:l()("Multiplayer"===N.tabName&&"battle-list"),children:[(0,n.jsx)(c.Z,{gameInfo:M.info,gameName:M.name,withButtons:!1,gameBanner:void 0,isAdmin:!1,refundData:{gameMode:"MINES",battleId:0}}),(0,n.jsx)(d.Z,{setShowJoinable:y,showJoinable:b,battlesCount:m.length,gameName:M.name,setCurrentTab:E,currentTab:N,handleCreateBattle:function(){s("createMinesBattle",!0),setTimeout(()=>{document.body.style.overflow="hidden",document.body.style.paddingRight=a.gap+"px"},0)}}),"Multiplayer"===N.tabName&&(0,n.jsx)(n.Fragment,{children:m.length?(0,n.jsx)("div",{className:"battles-grid",children:(b?m.filter(e=>{let{spots:t,players:a}=e;return a.length<t}):m).map((e,t)=>(0,n.jsx)(u.Z,{style:{animation:"bottomTop ".concat(t<5?.2+.15*t:1,"s")},gameMode:"Mines",gameData:e,isFull:e.players.length===e.spots,handleJoinFromOutside:joinFromOutside},t))}):(0,n.jsxs)("h1",{className:"empty-state-battle",children:["There are no battles right now, you can create one in top right"," "]})}),"SinglePlayer"===N.tabName&&(0,n.jsx)(single_mines,{})]}):(0,n.jsx)("h1",{children:"\uD83D\uDEE0BATTLE NOT FOUND, THIS IS MAYBE BECAUSE IT WAS DELETED... \uD83D\uDEA7"})}Mines.getLayout=e=>(0,n.jsx)(o.Z,{children:e})},4139:function(e){e.exports={insideBattlePage:"insideBattle_insideBattlePage__E0qi9",battleLayout:"insideBattle_battleLayout__jxLv_",stickyPlayers:"insideBattle_stickyPlayers__RBIPp",battleColumnLeft:"insideBattle_battleColumnLeft__OkcxS",battleColumnLeftInfo:"insideBattle_battleColumnLeftInfo__Ze45f",battleColumnLeftPlayers:"insideBattle_battleColumnLeftPlayers__9GKPt",infoLabel:"insideBattle_infoLabel__iG8U_",robuxValue:"insideBattle_robuxValue__BLv8C",playersNum:"insideBattle_playersNum__SpTX8",playersWrapper:"insideBattle_playersWrapper__X_sBm",playerItem:"insideBattle_playerItem__iu2dI",playerPp:"insideBattle_playerPp__YYtuD",showCurrentPlayerSvg:"insideBattle_showCurrentPlayerSvg__uIy6o",currentPlayerSvg:"insideBattle_currentPlayerSvg__oVWmV",rbxValueIcon:"insideBattle_rbxValueIcon__qrrwq",playerLOST:"insideBattle_playerLOST__CACVx",xIcon:"insideBattle_xIcon__ggq_i",playerUrTurn:"insideBattle_playerUrTurn__nQO_i",battleColumnRight:"insideBattle_battleColumnRight__9keZh"}},152:function(e){e.exports={minesCanvas:"mines_minesCanvas__uaL9P",minesCanvasDisabled:"mines_minesCanvasDisabled__me1pE",tilesContainer:"mines_tilesContainer__YvS_d",tile:"mines_tile__mQqpZ",misteryTile:"mines_misteryTile__9Ws48",badTile:"mines_badTile__8dAPZ",goodTile:"mines_goodTile__rNXBt"}},4551:function(e){e.exports={singleMines:"single-mines_singleMines__pm7Gu",fieldCol:"single-mines_fieldCol__3GiDc",towerControls:"single-mines_towerControls__XDVWp",buttonsRow:"single-mines_buttonsRow__DyyLP",manualBtn:"single-mines_manualBtn__uP6rV",fairnessBtn:"single-mines_fairnessBtn__s8CZ_",betAmountRow:"single-mines_betAmountRow__q03fK",amountInput:"single-mines_amountInput__Jphut",difficultyRow:"single-mines_difficultyRow__1KufF",difficultyTabs:"single-mines_difficultyTabs__N7boc",payoutRow:"single-mines_payoutRow__GHxj9",payoutInput:"single-mines_payoutInput__D9czP",startGameBtn:"single-mines_startGameBtn__re_kg",cashoutBtn:"single-mines_cashoutBtn__EOEfE"}}},function(e){e.O(0,[83,462,748,346,774,888,179],function(){return e(e.s=2045)}),_N_E=e.O()}]);